\RequirePackage{poetry-bfi}
\usepackage[perpage,para*]{manyfoot}
\newfootnote{D}
\newcounter{footnoteD}
\renewcommand{\thefootnoteD}{\emph{\alph{footnoteD}}}
\SelectFootnoteRule{default}
\newcommand{\footnoteD}{%
  \stepcounter{footnoteD}%
  {\Footnotemark\thefootnoteD}\FootnotetextD{}}
\MakePerPage{footnoteD}

\SelectFootnoteRule{default}
\newfootnote[para]{C}
\newcounter{footnoteC}
%\renewcommand{\thefootnoteC}{\fontfamily{MinionPro-OsF}\fontencoding{T1}\selectfont{[\arabic{footnoteC}]}}
\renewcommand{\thefootnoteC}{\alph{footnoteC}}
\newcommand{\footnoteC}{%
  \stepcounter{footnoteC}%
  {\Footnotemark\thefootnoteC}\FootnotetextC{}}
% \let\fnA\footnoteA
\MakePerPage{footnoteC}

\makeatletter
% counterless footnote from
% https://tex.stackexchange.com/questions/562763/footnote-without-reference
\newcommand\freefootnoteNormal[1]{%
  \let\svthefootnote\thefootnote
  \begingroup\freefootnotedef
  \let\thefootnote\relax%
  \footnotetext{#1}%
  \let\thefootnote\svthefootnote%
  \endgroup
}
\newcommand\freefootnoteD[1]{%
  \let\svthefootnote\thefootnoteD
  \begingroup\freefootnotedef
  \let\thefootnoteD\relax%
  \FootnotetextD{}{#1}%
  \let\thefootnoteD\svthefootnote%
  \endgroup
}
\newcommand\freefootnoteC[1]{%
  \let\svthefootnote\thefootnoteC
  \begingroup\freefootnotedef
  \let\thefootnoteC\relax%
  \FootnotetextC{}{#1}%
  \let\thefootnote\svthefootnote%
  \endgroup
}
%%% end
\makeatother
\ifcsname rechts\endcsname\else
  \newcommand{\rechts}[1]{\strut\hfill\mbox{#1}}
\fi
% \newcommand{\vocabseparator}{]}
\newcounter{previousline}
\setcounter{previousline}{-1}
\newcommand{\vocabseparator}{\,}
\newcommand{\vocabnote}[3][]{%
  \vocablemmanote[#1]{#2}{#2}{#3}}
\let\vocnote=\vocabnote
\ifcsname thepoemline\endcsname
  \let\thelinecounter=\thepoemline
  \newcommand{\linecounter}{poemline}
\else
  \ifcsname thelinenumber\endcsname
    \let\thelinecounter=\thelinenumber
    \newcommand{\linecounter}{linenumber}
  \else
    \newcommand{\linecounter}\errmessage{No supported line numbering present.}
    \let\thelinecounter=\linecounter
  \fi
\fi
\newcommand{\vocablemmanotePara}[4][]{%
    #2\ifx\vocfootnote\freefootnote\textsuperscript{*}\fi%
    \def\tmp{#1}%
    \def\tmptmp{#4}%
  \vocfootnote{\ifnum\the\value{previousline}=\the\value{\linecounter}\else\textbf{\thelinecounter} \fi\emph{#3}\hskip0.2ex\vocabseparator{}\ifx \tmp\empty\else \tmp{}\fi\ifx \tmptmp\empty\else ‚\tmptmp{}‘\fi.}\setcounter{previousline}{\value{\linecounter}}}
\newcommand{\vocablemmanoteClassic}[4][]{%
    #2\ifx\vocfootnote\freefootnote\textsuperscript{*}\fi%
    \def\tmp{#1}%
    \def\tmptmp{#4}%
  \vocfootnote{\textbf{\thepoemline} \emph{#3}\hskip0.2ex\vocabseparator{} \ifx \tmp\empty\else \tmp{} \fi\ifx \tmptmp\empty\else ‚\tmptmp{}‘\fi}}
\newcommand{\classicVocabnotes}{
    \let\vocablemmanote=\vocablemmanoteClassic
    \let\voclemnote=\vocablemmanote
    \let\freefootnote=\freefootnoteD
    \let\vocfootnote=\footnoteD
  }
\newcommand{\paraVocabnotes}{
  \let\vocablemmanote=\vocablemmanotePara
  \let\voclemnote=\vocablemmanotePara
  \let\freefootnote=\freefootnoteC
  \let\vocfootnote\freefootnote
}
\newcommand{\normalVocabnotes}{
  \let\vocablemmanote=\vocablemmanoteClassic
  \let\voclemnote=\vocablemmanoteClassic
  \let\freefootnote=\freefootnoteNormal
  \let\vocfootnote\freefootnoteNormal
}
\classicVocabnotes
\newlength{\vocabboxwidth}
\setlength{\vocabboxwidth}{6em}
\newlength{\phraseboxwidth}
\setlength{\phraseboxwidth}{13em}
\newlength{\vocabboxlinewidth}
\setlength{\vocabboxlinewidth}{.82\linewidth}
\newlength{\phraseboxlinewidth}
\setlength{\phraseboxlinewidth}{.57\linewidth}
\newcommand{\vocabbox}[2][]{%
    \def\tmp{#1}%
    \makebox[\vocabboxwidth][l]{\emph{#2} (Z. \ref{\ifx \tmp\empty word:#2\else word:#1\fi}):} \hfill\rule{\vocabboxlinewidth}{.4pt}\zeilen{1}
}
\newcommand{\phrasebox}[2][]{%
    \def\tmp{#1}%
    \makebox[\phraseboxwidth][l]{\emph{#2} (Z. \ref{\ifx \tmp\empty word:#2\else word:#1\fi}):} \hfill\rule{\phraseboxlinewidth}{.4pt}\zeilen{1}
}
\usepackage{forloop}
\newcounter{looping}
\newcommand{\zeilen}[1]{
\begingroup
    \parskip=1em
    \forloop{looping}{0}{\value{looping} < #1}{%
        \par{}\rule{\linewidth}{0.4pt}%
    }\vskip2em\endgroup}
\newcommand{\kurzzeilen}[1]{
    \begingroup
        \parskip=1em
        \forloop{looping}{0}{\value{looping} < #1}{%
            \par{}\rule{0.8\linewidth}{0.4pt}%
        }\vskip2em\endgroup}
